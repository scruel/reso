(()=>{var e={};e.id=658,e.ids=[658],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},582:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>y,routeModule:()=>p,serverHooks:()=>m,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>h});var s={};r.r(s),r.d(s,{GET:()=>d,POST:()=>c,dynamic:()=>l});var o=r(2706),n=r(8203),a=r(5994),i=r(9187);let l="force-dynamic",u=[];async function c(e){try{let t=await e.json();if(Array.isArray(t)){let r=t.map(t=>({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,type:t.type,timestamp:new Date(t.ts).toISOString(),userId:t.userId,url:t.url,userAgent:t.ua,payload:t.payload,serverTimestamp:new Date().toISOString(),ip:e.headers.get("x-forwarded-for")||"localhost"}));return u.push(...r),r.forEach(e=>{let t={pageview:`用戶 ${e.userId} 瀏覽了頁面`,scroll:`用戶 ${e.userId} 滿動到 ${e.payload?.depth||0}% 位置`,click:`用戶 ${e.userId} 點擊了商品 ${e.payload?.productId||"未知"}`,hover:`用戶 ${e.userId} 懸停在商品 ${e.payload?.productId||"未知"} 上`,search:`用戶 ${e.userId} 搜索了 "${e.payload?.query||"空搜索"}"`}[e.type]||`用戶 ${e.userId} 執行了 ${e.type} 操作`;console.log(`📊 ${t}`)}),u.length>200&&(u=u.slice(-200)),i.NextResponse.json({success:!0,message:`Logged ${r.length} client events`,count:r.length})}let r={id:Date.now().toString(),...t,serverTimestamp:new Date().toISOString(),ip:e.headers.get("x-forwarded-for")||"localhost"};return u.push(r),u.length>200&&(u=u.slice(-200)),console.log("\uD83D\uDCCA Client log:",r),i.NextResponse.json({success:!0,message:"Client event logged successfully",logId:r.id})}catch(e){return console.error("Client log error:",e),i.NextResponse.json({success:!1,error:"Failed to log client event"},{status:500})}}async function d(){let e=u.reduce((e,t)=>{let r=t.type||"unknown";return e[r]=(e[r]||0)+1,e},{});return i.NextResponse.json({success:!0,data:u,total:u.length,stats:e})}let p=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/client-log/route",pathname:"/api/client-log",filename:"route",bundlePath:"app/api/client-log/route"},resolvedPagePath:"/Users/alichen/Downloads/agent_workspace/ecommerce-search-main/frontend/src/app/api/client-log/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:g,workUnitAsyncStorage:h,serverHooks:m}=p;function y(){return(0,a.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:h})}},6487:()=>{},8335:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[989,452],()=>r(582));module.exports=s})();
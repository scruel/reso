(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[62],{5418:(e,t,r)=>{Promise.resolve().then(r.bind(r,9931))},5731:(e,t,r)=>{"use strict";async function s(e){try{console.log("\uD83D\uDD0D 调用后端 thread API，ID:",e);let t=await c("/api/thread?tid=".concat(e));if(console.log("\uD83D\uDCE1 后端 thread API 原始响应:",t),void 0!==t.status)if(0===t.status){let e={title:t.title,pic_url:t.pic_url,price:t.price,brand:t.brand,category:t.category,reference_links:Array.isArray(t.reference_links)?t.reference_links.join(", "):t.reference_links||"",dchain:t.dchain?{id:t.dchain.id.toString(),description:t.dchain.description,tbn_url:t.dchain.tbn_url,user_nick:t.dchain.user_nick}:void 0};return console.log("✅ 后端 thread API 响应已处理:",e),e}else throw Error("Backend error: ".concat(t.message||"Unknown error"));if(t.success&&t.data){let e=t.data;return e.dchain&&"number"==typeof e.dchain.id&&(e.dchain.id=e.dchain.id.toString()),e}if(!t.success&&!t.error)return t.dchain&&"number"==typeof t.dchain.id&&(t.dchain.id=t.dchain.id.toString()),t;if(t.error){let e=Error(t.error.message||"API錯誤");throw e.name=t.error.type||"ApiError",e}throw Error("無效的API響應格式")}catch(e){throw console.error("Failed to fetch thread detail:",e),e}}r.r(t),r.d(t,{apiDelete:()=>l,apiGet:()=>c,apiPost:()=>n,apiPut:()=>d,apiRequest:()=>i,fetchThreadDetail:()=>s,getApiUrl:()=>a});let a=e=>e.startsWith("/api/vibe")||e.startsWith("/api/thread")||e.startsWith("/api/products")?"".concat("http://demo.scruel.com:8000").concat(e):e,i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a(e),s={headers:{"Content-Type":"application/json",...t.headers},...t};try{let e=await fetch(r,s);if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}catch(e){throw console.error("API request failed for ".concat(r,":"),e),e}},c=e=>i(e,{method:"GET"}),n=(e,t)=>i(e,{method:"POST",body:JSON.stringify(t)}),d=(e,t)=>i(e,{method:"PUT",body:JSON.stringify(t)}),l=e=>i(e,{method:"DELETE"})},9931:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(5155),a=r(2115),i=r(5731);function c(){let[e,t]=(0,a.useState)([]),[r,c]=(0,a.useState)(!1),[n,d]=(0,a.useState)(null),l=async(e,r)=>{c(!0);try{console.log("\uD83E\uDDEA Testing: ".concat(e));let s=await (0,i.apiGet)(e);console.log("✅ Success:",s),t(t=>[...t,{endpoint:e,description:r,status:"success",data:s,timestamp:new Date().toLocaleTimeString()}])}catch(s){console.error("❌ Error:",s),t(t=>[...t,{endpoint:e,description:r,status:"error",error:s.message,timestamp:new Date().toLocaleTimeString()}])}c(!1)},o=async()=>{t([]),d(null),await l("/health","健康检查"),await l("/api/products","获取产品列表"),await l("/api/thread?tid=1","获取产品详情 (ID: 1)"),await l("/api/vibe?query=手机",'意图识别 (查询: "手机")'),await l("/api/vibe","意图识别 (无查询)")};return(0,a.useEffect)(()=>{o()},[]),(0,s.jsx)("div",{className:"min-h-screen bg-gray-100 py-8",children:(0,s.jsx)("div",{className:"container mx-auto px-4",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"后端API连接测试"}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"测试状态"}),(0,s.jsx)("button",{onClick:o,disabled:r,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 disabled:opacity-50",children:r?"测试中...":"重新测试"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[e.map((e,t)=>(0,s.jsxs)("div",{className:"p-4 rounded-lg border-l-4 ".concat("success"===e.status?"bg-green-50 border-green-400":"bg-red-50 border-red-400"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("h3",{className:"font-medium ".concat("success"===e.status?"text-green-800":"text-red-800"),children:e.description}),(0,s.jsx)("span",{className:"text-sm text-gray-500",children:e.timestamp})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:(0,s.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:e.endpoint})}),"success"===e.status?(0,s.jsxs)("div",{className:"bg-gray-50 p-3 rounded text-sm",children:[(0,s.jsx)("p",{className:"text-green-600 font-medium mb-2",children:"✅ 成功响应"}),(0,s.jsx)("pre",{className:"text-gray-700 overflow-x-auto",children:JSON.stringify(e.data,null,2)})]}):(0,s.jsxs)("div",{className:"bg-gray-50 p-3 rounded text-sm",children:[(0,s.jsx)("p",{className:"text-red-600 font-medium mb-2",children:"❌ 错误信息"}),(0,s.jsx)("p",{className:"text-red-700",children:e.error})]})]},t)),0===e.length&&!r&&(0,s.jsx)("p",{className:"text-gray-500 text-center py-8",children:'点击"重新测试"开始API连接测试'})]})]}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"font-medium text-blue-800 mb-2",children:"\uD83D\uDCCB 测试说明"}),(0,s.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,s.jsxs)("li",{children:["• 后端服务器: ",(0,s.jsx)("code",{children:"http://demo.scruel.com:8000"})]}),(0,s.jsx)("li",{children:"• 测试包括健康检查、产品列表、产品详情和意图识别"}),(0,s.jsx)("li",{children:"• 绿色表示成功，红色表示失败"}),(0,s.jsx)("li",{children:"• 查看浏览器控制台获取更多调试信息"})]})]})]})})})}}},e=>{e.O(0,[441,964,358],()=>e(e.s=5418)),_N_E=e.O()}]);